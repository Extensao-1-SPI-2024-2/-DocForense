{% extends "base.html" %}

{% block title %}Configurações{% endblock %}
{% block maintitle %}Configurações{% endblock %}

{% block breadcrumb %}
  <li class="breadcrumb-item active" aria-current="page">Configurações</li>
{% endblock %}

{% block content %}
  <div class="card py-3 px-2 bg-white">
    <div class="p-2">
      <h5>Usuários e Permissões</h5>
    </div>
    <div class="card-body">
      <table id="listagem" class="table table-striped table-bordered" style="width:100%">
        <thead>
          <tr>
            <th>Nome</th>
            <th>É SuperUsuário?</th>
            <th>É Staff?</th>
            <th>Inclusão</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
            <tr>
              <td>{{ user.first_name }} {{ user.last_name }}</td>
              <td>
                {% if user.is_superuser %}
                    <span class="badge text-bg-success" style="font-size: 0.9rem;">Sim</span>
                {% else %}
                    <span class="badge text-bg-danger" style="font-size: 0.9rem;">Não</span>
                {% endif %}
              </td>
              <td>
                {% if user.is_staff %}
                    <span class="badge text-bg-success" style="font-size: 0.9rem;">Sim</span>
                {% else %}
                    <span class="badge text-bg-danger" style="font-size: 0.9rem;">Não</span>
                {% endif %}
              </td>
              <td>{{ user.date_joined|date:'d/m/Y H:i' }}</td>
              <td class="is-narrow">
                <div class="text-end">
                    {% if user.is_superuser %}
                        <a href="/configuracao/superuser/remove/{{ user.id }}"><button title="Remover SuperUser" class="btn btn-danger btn-sm"><i class="fas fa-user-slash"></i></button></a>
                    {% else %}
                        <a href="/configuracao/superuser/add/{{ user.id }}"><button title="Conceder SuperUser" class="btn btn-success btn-sm"><i class="fas fa-user"></i></button></a>
                    {% endif %}
                    {% if login_user.is_staff %}
                        {% if user.is_staff %}
                            <a href="/configuracao/staff/remove/{{ user.id }}"><button title="Remover Staff" class="btn btn-danger btn-sm"><i class="fas fa-users-slash"></i></button></a>
                        {% else %}
                            <a href="/configuracao/staff/add/{{ user.id }}"><button title="Conceder Staff" class="btn btn-success btn-sm"><i class="fas fa-users"></i></button></a>
                        {% endif %}
                    {% endif %}
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.5/js/dataTables.bootstrap5.min.js"></script>
  <script>
    $(document).ready(function () {
      $('#listagem').DataTable({
        // Opções de personalização
        paging: true, // Habilita paginação
        searching: false, // Habilita barra de pesquisa
        info: true, // Exibe informações como "Mostrando X de Y"
        lengthChange: true, // Permite alterar o número de linhas exibidas
        pageLength: 10, // Define o número padrão de linhas por página
        language: {
          url: "https://cdn.datatables.net/plug-ins/1.13.5/i18n/pt-BR.json"
        }
      })
    });
  </script>
{% endblock %}
